<body>
<div class="container my-5">
  <div class="row col-4">
    <% if @search_results.empty? %>
      <p>No mates found for you</p>
    <% else %>
      <% @search_results.each do |search_result| %>
        <div>
          <%= search_result.username %>
          <%= search_result.age %>
          <%= search_result.gender %>
          <br>
          <% user_game = search_result.user_games.find_by(game: Game.find_by(name: params[:name])) %>
          <% if user_game %>
            <%= user_game.mood %>
            <%= user_game.level %>
            <%= user_game.game.name %>
            <%= button_to "Like", profile_likes_path(profile_id: search_result.id, current_user_id: current_user.id, name: params[:name], level: params[:level], mood: params[:mood], gender: params[:gender], age: params[:age]), method: :post, params: { liked_user_id: search_result.id }, class: "like-button", remote: true %>
          <% else %>
            <p>User game not found</p>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
</body>
<script>
  $(document).ready(function() {
    $(".like-button").on("ajax:success", function(event) {
      // Réponse réussie de la requête AJAX
      var data = event.detail[0];

      // Mettre à jour l'interface utilisateur en conséquence
      if (data.success) {
        // Le like a été enregistré avec succès, effectuez les modifications nécessaires dans l'interface
        alert("User liked successfully.");
      } else {
        // Une erreur s'est produite lors de l'enregistrement du like, affichez un message d'erreur ou effectuez d'autres actions nécessaires
        alert("An error occurred while liking the user.");
      }
    });
  });
</script>
